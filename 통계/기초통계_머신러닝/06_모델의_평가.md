# 통계및머신러닝
## 7) 모델의 평가
### R 스퀘어 (결정계수)
- 결정계수란 이 선이 데이터를 잘 표현하고 있는가를 정량화 한 수치이다
- R 스퀘어 = 회귀모형에 의해 설명되는 변동/ 총 변동이다
- 즉, SSR/SST = 1 - SSE/SST 이다
- 결정계수는 0 이상이고 1 이하이다
- SST(총변동) = SSE(오차에 의한 변동) + SSR(회귀선에 의한 변동) 이다
- 기울기가 없으면 SSR 은 없다
- 독립변수를 추가하면 결정계수 값은 상승하기 때문에 개선된 R 스퀘어를 사용한다
- 개선된 R 스퀘어는 1 - (SSE/(n-k))/(SST/(n-1)) = 1 - ( (1-R스퀘어)(n-1) / n-k-1 )
- 학습오차란 모델 적합에 사용한 데이터로 측정한 오차이다
- 예측오차란 모델 적합에 사용하지 않은 데이터로 측정한 오차이다
- 오차에는 MSE, RMSE, MAE, MAPE 가 있으며 작을수록 좋다

- 회귀분석에서 범주형 데이터가 있다면 가변수화 혹은 one-hot encoding 을 통해 수치형 데이터로 변환한다
- 가변수란 범주형 자료를 0과 1로 표현한 것이다

### 카이제곱 검정
- 카이제곱 검정은 범주로 분류만 가능한 자료 (입출력이 모두 범주형) 분석에 사용된다
- 분할표란 두가지 혹은 그 이상의 속성에 따라 분류된 표본 관측값으로부터 얻어지는 도수로 구성되는 데이터이다
- 여러 모집단을 비교하는 방법으로 적합도, 독립성, 동질성 검정이다
- 적합성은 보통 1집단, 독립성은 2집단, 동질성은 여러 집단을 비교한다
- 카이제곱 검정통계량은 (관측치 - 기대치) 제곱 / 기대치를 모두 더한 것이다
- 카이제곱의 자유도는 (열수-1)(행수-1) 이다
- 독립성 검정은 두 개의 요인을 대상으로 한다
- 동질성 검정은 부모집단의 비율이 동일한가를 검정하며 두 개의 요인을 대상으로 한다
- 분할표의 각 칸이 기대도수가 5 이하인 셀이 20% 이상이면 카이제곱 검정을 사용할 수 없다
- 카이제곱 검정은 대표본에서만 유효한 근사검정으로 이러한 제약을 피셔의 정확검정으로 대체할 수 있다

### 데이터 전처리
- 데이터 품질이 높은 경우에도 전처리는 필요하다
  - 구조적 형태가 분석 목적에 적합하지 않은 경우
  - 사용하는 툴, 기법에서 요구하는 데이터 형태
  - 데이터가 너무 많은 경우
- 데이터 품질을 낮추는 주요 원인은 불완전(결측치), 잡음(이상치), 모순(비일관) 이 있다
- 결측치 처리에는 평균값을 사용하거나 보간법이 있다
- 이상치는 분산 혹은 우도를 통해 탐지하며 Nearest-neighbor, Density, Clustering 등 기계학습 기법을 활용할 수 있다
  - IQR , tukey, Carling 방법으로도 탐지가능하다
- LOF(Local Outlier Factor) 는 관측치의 비정상적인 정도를 점수로 반영하여 거리와 밀도를 함계 고려하는 아웃라이어 제거 방법이다
- 잡음에서 중복이 있을 수 있는데 이는 룰, 정규화 등을 통해 판단 및 해결하며 동일 데이터에 대한 속성값의 차이도 잡음이다( 표현, 척도, 부호, 데이터 레벨의 차이)
- 잡음 처리는 구간화, 회귀, 군집화를 통해 한다